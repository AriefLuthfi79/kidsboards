<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>
  File: API
  
    &mdash; Documentation by YARD 0.8.7.6
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!file.API.html";
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: API</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><div id='filecontents'>
<h1 id="label-API+Reference">API Reference</h1>

<h2 id="label-About">About</h2>

<p>Thatsaboy API is organized around REST. This API has predictable,
resource-oriented URLs, and uses HTTP response codes to indicate API
errors. JSON(or nothing in case of 204) is returned by all API responses,
including errors.</p>

<h3 id="label-Authentication">Authentication</h3>

<p>Authentication to the API is performed via token-based system. In most
cases token must be sent as a POST parameter.</p>

<h3 id="label-Errors">Errors</h3>

<p>API uses HTTP response codes to indicate the success or failure of an API
request. In general, codes 200 and 204 indicate success, codes in the 4xx
range indicate an error that failed given the information provided, and 500
code indicates an error with Thatsaboy&#39;s servers (these are rare).</p>

<h3 id="label-HTTP+status+code+summary">HTTP status code summary</h3>
<ul><li>
<p>200 - OK. Everything worked as expected and there is some response.</p>
</li><li>
<p>204 - OK. Everything worked as expected and there is an empty response.</p>
</li><li>
<p>401 - Unauthorized. No valid token provided.</p>
</li><li>
<p>403 - Forbidden. User has no permissions to run this action.</p>
</li><li>
<p>404 - Not Found. The requested path doesn&#39;t exist.</p>
</li><li>
<p>500 - Server Error. Something went wrong on API&#39;s end. (These are
rare.)</p>
</li></ul>

<h3 id="label-Common+validation+errors">Common validation errors</h3>
<ul><li>
<p>is invalid</p>
</li><li>
<p>can&#39;t be blank</p>
</li><li>
<p>is too short (minimum is N characters)</p>
</li><li>
<p>has wrong format</p>
</li></ul>

<h2 id="label-User">User</h2>

<h3 id="label-Register">Register</h3>

<p>Registers new user.</p>

<p><code>POST /api/v1/user/register</code></p>

<p>Parameters:</p>
<ul><li>
<p>email</p>
</li><li>
<p>password (at least 6 characters)</p>
</li></ul>

<p>Possible responses:</p>
<ul><li>
<p>200</p>
</li><li>
<p>422</p>
</li></ul>

<p>Response example:</p>

<pre class="code ruby"><code class="ruby"><span class='lbrace'>{</span>
  <span class='label'>id:</span> <span class='int'>1</span>
<span class='rbrace'>}</span>
</code></pre>

<h3 id="label-Login">Login</h3>

<p>Checks presented email and password and returns a token if they are right.</p>

<p><code>POST /api/v1/user/login</code></p>

<p>Parameters:</p>
<ul><li>
<p>email</p>
</li><li>
<p>password (at least 6 characters)</p>
</li></ul>

<p>Possible responses:</p>
<ul><li>
<p>200</p>
</li><li>
<p>422</p>
</li></ul>

<p>Response example:</p>

<pre class="code ruby"><code class="ruby"><span class='lbrace'>{</span>
    <span class='label'>token:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>abcdef12345</span><span class='tstring_end'>&#39;</span></span>
<span class='rbrace'>}</span>
</code></pre>

<p>Additional validation errors:</p>
<ul><li>
<p><code>{email: &#39;Wrong email or password&#39;}</code></p>
</li></ul>

<h3 id="label-Logout">Logout</h3>

<p>Marks the token as expired.</p>

<p><code>POST /api/v1/user/logout</code></p>

<p>Parameters:</p>
<ul><li>
<p>token</p>
</li></ul>

<p>Possible responses:</p>
<ul><li>
<p>204</p>
</li><li>
<p>401</p>
</li></ul>

<h3 id="label-Confirm">Confirm</h3>

<p>Confirms user&#39;s email.</p>

<p><code>GET /api/v1/user/confirm/:token</code></p>

<p>Parameters:</p>
<ul><li>
<p>token</p>
</li></ul>

<p>Possible responses:</p>
<ul><li>
<p>204</p>
</li><li>
<p>401</p>
</li></ul>

<h3 id="label-Password+recovery+request">Password recovery request</h3>

<p>Sends an email to the user with instructions to recovery the password.</p>

<p><code>POST /api/v1/user/request</code></p>

<p>Parameters:</p>
<ul><li>
<p>email</p>
</li></ul>

<p>Possible responses:</p>
<ul><li>
<p>204</p>
</li><li>
<p>422</p>
</li></ul>

<h3 id="label-Password+recovery">Password recovery</h3>

<p>Changes user&#39;s password.</p>

<p><code>POST /api/v1/user/recovery</code></p>

<p>Parameters:</p>
<ul><li>
<p>password (at least 6 characters)</p>
</li></ul>

<p>Possible responses:</p>
<ul><li>
<p>204</p>
</li><li>
<p>401</p>
</li><li>
<p>422</p>
</li></ul>

<h3 id="label-Pin+set">Pin set</h3>

<p>Sets a new pin code. Pin is needed to avoid children to change something.
Because in this case our enemies are just kids the security level is very
low.</p>

<p><code>PATCH /api/v1/user/pin</code></p>

<p>Parameters:</p>
<ul><li>
<p>token</p>
</li><li>
<p>pin (4 digits as a string)</p>
</li></ul>

<p>Possible responses:</p>
<ul><li>
<p>204</p>
</li><li>
<p>401</p>
</li><li>
<p>422</p>
</li></ul>

<h3 id="label-Pin+check">Pin check</h3>

<p>Checks that the pin is correct.</p>

<p><code>GET /api/v1/user/pin</code></p>

<p>Parameters:</p>
<ul><li>
<p>token</p>
</li><li>
<p>pin (4 digits as a string)</p>
</li></ul>

<p>Possible responses:</p>
<ul><li>
<p>200</p>
</li><li>
<p>401</p>
</li><li>
<p>422</p>
</li></ul>

<p>Response example:</p>

<pre class="code ruby"><code class="ruby"><span class='lbrace'>{</span>
     <span class='label'>equal:</span> <span class='kw'>true</span>
<span class='rbrace'>}</span>
</code></pre>

<h2 id="label-File">File</h2>

<h3 id="label-Create+a+photo">Create a photo</h3>

<p>Creates a photo.</p>

<p><code>POST /api/v1/file/photo</code></p>

<p>Parameters:</p>
<ul><li>
<p>token</p>
</li><li>
<p>file (only images)</p>
</li></ul>

<p>Possible responses:</p>
<ul><li>
<p>200</p>
</li><li>
<p>401</p>
</li><li>
<p>422</p>
</li></ul>

<p>Response example:</p>

<pre class="code ruby"><code class="ruby"><span class='lbrace'>{</span>
     <span class='label'>id:</span> <span class='int'>1</span><span class='comma'>,</span>
     <span class='label'>photo_url:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>url</span><span class='tstring_end'>&#39;</span></span>
<span class='rbrace'>}</span>
</code></pre>

<p>Additional validation errors:</p>
<ul><li>
<p><code>{file: &#39;wrong type&#39;}</code></p>
</li></ul>

<h3 id="label-List+of+photos">List of photos</h3>

<p>Shows the list of photos uploaded by the user.</p>

<p><code>GET /api/v1/file/photo</code></p>

<p>Parameters:</p>
<ul><li>
<p>token</p>
</li></ul>

<p>Possible responses:</p>
<ul><li>
<p>200</p>
</li><li>
<p>401</p>
</li></ul>

<p>Response example:</p>

<pre class="code ruby"><code class="ruby">{
     photos:
     [
         {
             id: 1,
             photo_url: &#39;url&#39;
         },
         {
             id: 2,
             photo_url: &#39;url&#39;
         },
         ...
     ]
}</code></pre>

<h3 id="label-Delete+a+photo">Delete a photo</h3>

<p>Deletes the photo.</p>

<p><code>DELETE /api/v1/file/photo/:id</code></p>

<p>Parameters:</p>
<ul><li>
<p>token</p>
</li></ul>

<p>Possible responses:</p>
<ul><li>
<p>204</p>
</li><li>
<p>401</p>
</li><li>
<p>403</p>
</li><li>
<p>422</p>
</li></ul>

<h2 id="label-Family">Family</h2>

<h3 id="label-View">View</h3>

<p>Shows information about the family.</p>

<p><code>GET /api/v1/family</code></p>

<p>Parameters:</p>
<ul><li>
<p>token</p>
</li></ul>

<p>Possible responses:</p>
<ul><li>
<p>200</p>
</li><li>
<p>401</p>
</li></ul>

<p>Response example:</p>

<pre class="code ruby"><code class="ruby">{
   name: Bill,
   photo_url: url,
   adults:
        [
            {
                id: 1,
                name: &#39;Bill&#39;,
                photo_url: &#39;url&#39;
            },
            {
                id: 2,
                name: &#39;John&#39;,
                photo_url: &#39;url&#39;
            },
            ...
        ],
   children:
        [
            {
                id: 1,
                name: &#39;Bill&#39;,
                photo_url: &#39;url&#39;
            },
            {
                id: 2,
                name: &#39;John&#39;,
                photo_url: &#39;url&#39;
            },
            ...
        ]
}</code></pre>

<h3 id="label-Update">Update</h3>

<p>Updates the family.</p>

<p><code>PUT /api/v1/family</code></p>

<p>Parameters:</p>
<ul><li>
<p>token</p>
</li><li>
<p>name</p>
</li><li>
<p>photo_url</p>
</li></ul>

<p>Possible responses:</p>
<ul><li>
<p>204</p>
</li><li>
<p>401</p>
</li><li>
<p>422</p>
</li></ul>

<h3 id="label-Adult">Adult</h3>

<h4 id="label-Create">Create</h4>

<p>Creates an adult.</p>

<p><code>POST /api/v1/family/adult</code></p>

<p>Parameters:</p>
<ul><li>
<p>token</p>
</li><li>
<p>name</p>
</li><li>
<p>photo_url</p>
</li></ul>

<p>Possible responses:</p>
<ul><li>
<p>200</p>
</li><li>
<p>401</p>
</li><li>
<p>422</p>
</li></ul>

<p>Response example:</p>

<pre class="code ruby"><code class="ruby"><span class='lbrace'>{</span>
  <span class='label'>id:</span> <span class='int'>1</span>
<span class='rbrace'>}</span>
</code></pre>

<h4 id="label-Update">Update</h4>

<p>Updates the adult.</p>

<p><code>PUT /api/v1/family/adult/:id</code></p>

<p>Parameters:</p>
<ul><li>
<p>token</p>
</li><li>
<p>name</p>
</li><li>
<p>photo_url</p>
</li></ul>

<p>Possible responses:</p>
<ul><li>
<p>204</p>
</li><li>
<p>401</p>
</li><li>
<p>403</p>
</li><li>
<p>422</p>
</li></ul>

<h4 id="label-Delete">Delete</h4>

<p>Deletes the adult.</p>

<p><code>DELETE /api/v1/family/adult/:id</code></p>

<p>Parameters:</p>
<ul><li>
<p>token</p>
</li></ul>

<p>Possible responses:</p>
<ul><li>
<p>204</p>
</li><li>
<p>401</p>
</li><li>
<p>403</p>
</li></ul>

<h3 id="label-Child">Child</h3>

<h4 id="label-Create">Create</h4>

<p>Creates a child.</p>

<p><code>POST /api/v1/family/child</code></p>

<p>Parameters:</p>
<ul><li>
<p>token</p>
</li><li>
<p>name</p>
</li><li>
<p>photo_url</p>
</li></ul>

<p>Possible responses:</p>
<ul><li>
<p>200</p>
</li><li>
<p>401</p>
</li><li>
<p>422</p>
</li></ul>

<p>Response example:</p>

<pre class="code ruby"><code class="ruby"><span class='lbrace'>{</span>
  <span class='label'>id:</span> <span class='int'>1</span>
<span class='rbrace'>}</span>
</code></pre>

<h4 id="label-Update">Update</h4>

<p>Updates the child.</p>

<p><code>PUT /api/v1/family/child/:id</code></p>

<p>Parameters:</p>
<ul><li>
<p>token</p>
</li><li>
<p>name</p>
</li><li>
<p>photo_url</p>
</li></ul>

<p>Possible responses:</p>
<ul><li>
<p>204</p>
</li><li>
<p>401</p>
</li><li>
<p>403</p>
</li><li>
<p>422</p>
</li></ul>

<h4 id="label-Delete">Delete</h4>

<p>Deletes the child.</p>

<p><code>DELETE /api/v1/family/child/:id</code></p>

<p>Parameters:</p>
<ul><li>
<p>token</p>
</li></ul>

<p>Possible responses:</p>
<ul><li>
<p>204</p>
</li><li>
<p>401</p>
</li><li>
<p>403</p>
</li></ul>

<h3 id="label-Goal">Goal</h3>

<h4 id="label-Create">Create</h4>

<p>Creates a goal.</p>

<p><code>POST /api/v1/family/child/:id/goal</code></p>

<p>Parameters:</p>
<ul><li>
<p>token</p>
</li><li>
<p>name</p>
</li><li>
<p>photo_url</p>
</li><li>
<p>target (an integer between 0 and 1000)</p>
</li></ul>

<p>Possible responses:</p>
<ul><li>
<p>200</p>
</li><li>
<p>401</p>
</li><li>
<p>403</p>
</li><li>
<p>422</p>
</li></ul>

<p>Response example:</p>

<pre class="code ruby"><code class="ruby"><span class='lbrace'>{</span>
  <span class='label'>id:</span> <span class='int'>1</span>
<span class='rbrace'>}</span>
</code></pre>

<h4 id="label-Index">Index</h4>

<p>Shows the list of goals.</p>

<p><code>GET /api/v1/family/child/:id/goal</code></p>

<p>Parameters:</p>
<ul><li>
<p>token</p>
</li><li>
<p>completed (true or false)</p>
</li></ul>

<p>Possible responses:</p>
<ul><li>
<p>200</p>
</li><li>
<p>401</p>
</li><li>
<p>403</p>
</li><li>
<p>422</p>
</li></ul>

<p>Response example:</p>

<pre class="code ruby"><code class="ruby">{
     goals:
     [
         {
             id: 1,
             name: &#39;doll&#39;,
             photo_url: &#39;url&#39;,
             target: 50,
             current: 10
         },
         {
             id: 2,
             name: &#39;doll&#39;,
             photo_url: &#39;url&#39;,
             target: 50,
             current: 10
         },
         ...
     ]
}</code></pre>

<h2 id="label-Goal">Goal</h2>

<h3 id="label-View">View</h3>

<p>Shows the goal.</p>

<p><code>GET /api/v1/file/goal/:id</code></p>

<p>Parameters:</p>
<ul><li>
<p>token</p>
</li></ul>

<p>Possible responses:</p>
<ul><li>
<p>200</p>
</li><li>
<p>401</p>
</li><li>
<p>403</p>
</li><li>
<p>422</p>
</li></ul>

<p>Response example:</p>

<pre class="code ruby"><code class="ruby">{
   id: 1,
   name: &#39;doll&#39;,
   photo_url: &#39;url&#39;,
   target: 50,
   current: 10,
   created_at: datetime_utc,
   actions:
        [
            {
                adult:
                    {
                        id: 1,
                        name: &#39;John&#39;,
                        photo_url: &#39;url&#39;,
                    }
                diff: 12,
                created_at: datetime_utc
            },
            {
                adult:
                    {
                        id: 1,
                        name: &#39;John&#39;,
                        photo_url: &#39;url&#39;,
                    }
                diff: -2,
                created_at: datetime_utc
            },
        ]
}</code></pre>

<h3 id="label-Update">Update</h3>

<p>Updates the goal.</p>

<p><code>PUT /api/v1/file/goal/:id</code></p>

<p>Parameters:</p>
<ul><li>
<p>token</p>
</li><li>
<p>name</p>
</li><li>
<p>photo_url</p>
</li><li>
<p>target (an integer between 0 and 1000)</p>
</li></ul>

<p>Possible responses:</p>
<ul><li>
<p>204</p>
</li><li>
<p>401</p>
</li><li>
<p>403</p>
</li><li>
<p>422</p>
</li></ul>

<h3 id="label-Delete">Delete</h3>

<p>Deletes the goal.</p>

<p><code>DELETE /api/v1/file/goal/:id</code></p>

<p>Parameters:</p>
<ul><li>
<p>token</p>
</li></ul>

<p>Possible responses:</p>
<ul><li>
<p>204</p>
</li><li>
<p>401</p>
</li><li>
<p>403</p>
</li><li>
<p>422</p>
</li></ul>

<h3 id="label-Points+update">Points update</h3>

<p>Adds or removes points of the goal.</p>

<p><code>PATCH /api/v1/file/goal/:id/points</code></p>

<p>Parameters:</p>
<ul><li>
<p>token</p>
</li><li>
<p>diff (integer)</p>
</li><li>
<p>adult_id</p>
</li></ul>

<p>Possible responses:</p>
<ul><li>
<p>200</p>
</li><li>
<p>401</p>
</li><li>
<p>403</p>
</li><li>
<p>422</p>
</li></ul>

<p>Response example:</p>

<pre class="code ruby"><code class="ruby"><span class='lbrace'>{</span>
   <span class='label'>current:</span> <span class='int'>10</span><span class='comma'>,</span>
   <span class='label'>target:</span> <span class='int'>12</span>
 <span class='rbrace'>}</span>
</code></pre>
</div></div>

    <div id="footer">
  Generated on Wed Feb 10 20:51:59 2016 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.6 (ruby-2.3.0).
</div>

  </body>
</html>